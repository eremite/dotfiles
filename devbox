# Starts a new devbox container or attaches to the running one if it exists

# Hat tip: https://gist.github.com/ekristen/11254304

function run_container {
  sudo docker pull eremite/devbox
  sudo docker run -it --rm --name devbox --volumes-from data -v $HOME/meta:/data/meta -v /var/run/docker.sock:/var/run/docker.sock eremite/devbox ./init.sh
}

CONTAINER=devbox

RUNNING=$(sudo docker inspect --format="{{ .State.Running }}" $CONTAINER 2> /dev/null)

if [ $? -eq 1 ]; then # doesn't exist
  run_container
elif [ "$RUNNING" == "false" ]; then
  sudo docker rm -v devbox
  run_container
else
  sudo docker attach $CONTAINER
fi
